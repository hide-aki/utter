{"remainingRequest":"/var/www/html/utter/node_modules/react-hot-loader/webpack.js!/var/www/html/utter/node_modules/babel-loader/lib/index.js!/var/www/html/utter/client/src/services/socketio/index.js","dependencies":[{"path":"/var/www/html/utter/client/src/services/socketio/index.js","mtime":1514570537621},{"path":"/var/www/html/utter/.babelrc","mtime":1518822814526},{"path":"/var/www/html/utter/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/var/www/html/utter/node_modules/react-hot-loader/webpack.js","mtime":1510167650000},{"path":"/var/www/html/utter/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _socket = require('socket.io-client');\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nvar _store = require('../../store.js');\n\nvar _store2 = _interopRequireDefault(_store);\n\nvar _actions = require('../socketio/actions.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Socket = function () {\n  function Socket(opts) {\n    (0, _classCallCheck3.default)(this, Socket);\n\n    this.opts = { autoUpgrade: false, peerOpts: { numClients: 10 } };\n  }\n\n  (0, _createClass3.default)(Socket, [{\n    key: 'connect',\n    value: function connect() {\n      var _this = this;\n\n      this.socket = (0, _socket2.default)();\n      return new Promise(function (resolve, reject) {\n        _this.socket.on('connection', function (nsp) {\n          // return state of socket in redux\n          resolve(nsp);\n        });\n        _this.socket.on('connect_error', function (error) {\n          return reject(error);\n        });\n      });\n    }\n  }, {\n    key: 'nspConnect',\n    value: function nspConnect(namespace) {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this2.nsp = (0, _socket2.default)('/' + namespace);\n        _this2.nsp.on('connection', function (nsp) {\n          // return state of socket in redux\n          resolve({ nsp: nsp, socket: socket });\n        });\n\n        _this2.nsp.on('connect_error', function (error) {\n          return reject(error);\n        });\n\n        _this2.nsp.on('receive audio blob', function (blob) {\n          _store2.default.dispatch((0, _actions.receiveAudioBlob)(blob));\n        });\n\n        _this2.nsp.on('receive room meta', function (meta) {\n          _store2.default.dispatch((0, _actions.receiveRoomMeta)(meta));\n        });\n\n        _this2.nsp.on('receive msg', function (msg) {\n          _store2.default.dispatch((0, _actions.receiveMsg)(msg));\n        });\n      });\n    }\n  }, {\n    key: 'disconnect',\n    value: function disconnect() {\n      var _this3 = this;\n\n      return new Promise(function (resolve) {\n        _this3.socket.disconnect(function () {\n          _this3.socket.on('disconnect', function () {\n            resolve();\n          });\n        });\n      });\n    }\n  }, {\n    key: 'emit',\n    value: function emit(event, data) {\n      var _this4 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (!_this4.nsp || !_this4.socket) return reject('No socket connection');\n\n        if (_this4.nsp) {\n          return _this4.nsp.emit(event, data, function (response) {\n            if (response.error) {\n              console.error(response.error);\n              return reject(response.error);\n            }\n            return resolve(response);\n          });\n        } else if (_this4.socket) {\n          return socket.emit(event, data, function (response) {\n            if (response.error) {\n              console.error(response.error);\n              return reject(response.error);\n            }\n            return resolve(response);\n          });\n        }\n      });\n    }\n  }, {\n    key: 'on',\n    value: function on(event, data) {\n      var _this5 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (!_this5.nsp || !_this5.socket) return reject('No socket connection');\n\n        if (_this5.nsp) {\n          _this5.nsp.on(event, data);\n          resolve(data);\n        } else if (_this5.socket) {\n          _this5.socket.on(event, data);\n          resolve();\n        }\n      });\n    }\n\n    // on(event, fun) {\n    //   // No promise is needed here, but we're expecting one in the middleware.\n    //   return new Promise((resolve, reject) => {\n    //     if (!this.socket) return reject('No socket connection.')\n\n    //     this.socket.on(event, fun)\n    //     resolve()\n    //   })\n    // }\n\n  }]);\n  return Socket;\n}();\n\nvar _default = Socket;\nexports.default = _default;\n;\n\nvar _temp = function () {\n  if (typeof __REACT_HOT_LOADER__ === 'undefined') {\n    return;\n  }\n\n  __REACT_HOT_LOADER__.register(Socket, 'Socket', '/var/www/html/utter/client/src/services/socketio/index.js');\n\n  __REACT_HOT_LOADER__.register(_default, 'default', '/var/www/html/utter/client/src/services/socketio/index.js');\n}();\n\n;\n\n ;(function register() { /* react-hot-loader/webpack */ if (process.env.NODE_ENV !== 'production') { if (typeof __REACT_HOT_LOADER__ === 'undefined') { return; } /* eslint-disable camelcase, no-undef */ var webpackExports = typeof __webpack_exports__ !== 'undefined' ? __webpack_exports__ : module.exports; /* eslint-enable camelcase, no-undef */ if (typeof webpackExports === 'function') { __REACT_HOT_LOADER__.register(webpackExports, 'module.exports', \"/var/www/html/utter/client/src/services/socketio/index.js\"); return; } /* eslint-disable no-restricted-syntax */ for (var key in webpackExports) { /* eslint-enable no-restricted-syntax */ if (!Object.prototype.hasOwnProperty.call(webpackExports, key)) { continue; } var namedExport = void 0; try { namedExport = webpackExports[key]; } catch (err) { continue; } __REACT_HOT_LOADER__.register(namedExport, key, \"/var/www/html/utter/client/src/services/socketio/index.js\"); } } })();","{\"version\":3,\"sources\":[\"/var/www/html/utter/client/src/services/socketio/index.js\"],\"names\":[\"Socket\",\"opts\",\"autoUpgrade\",\"peerOpts\",\"numClients\",\"socket\",\"Promise\",\"resolve\",\"reject\",\"on\",\"nsp\",\"error\",\"namespace\",\"dispatch\",\"blob\",\"meta\",\"msg\",\"disconnect\",\"event\",\"data\",\"emit\",\"response\",\"console\"],\"mappings\":\";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AAEA;;;;IAMMA,M;AACJ,kBAAYC,IAAZ,EAAkB;AAAA;;AAChB,SAAKA,IAAL,GAAY,EAACC,aAAa,KAAd,EAAqBC,UAAU,EAACC,YAAY,EAAb,EAA/B,EAAZ;AACD;;;;8BACS;AAAA;;AACR,WAAKC,MAAL,GAAc,uBAAd;AACA,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,cAAKH,MAAL,CAAYI,EAAZ,CAAe,YAAf,EAA6B,eAAO;AAClC;AACAF,kBAAQG,GAAR;AACD,SAHD;AAIA,cAAKL,MAAL,CAAYI,EAAZ,CAAe,eAAf,EAAgC;AAAA,iBAASD,OAAOG,KAAP,CAAT;AAAA,SAAhC;AACD,OANM,CAAP;AAOD;;;+BAEUC,S,EAAW;AAAA;;AACpB,aAAO,IAAIN,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,eAAKE,GAAL,GAAW,4BAAOE,SAAP,CAAX;AACA,eAAKF,GAAL,CAASD,EAAT,CAAY,YAAZ,EAA0B,eAAO;AAC/B;AACAF,kBAAQ,EAACG,QAAD,EAAML,cAAN,EAAR;AACD,SAHD;;AAKA,eAAKK,GAAL,CAASD,EAAT,CAAY,eAAZ,EAA6B;AAAA,iBAASD,OAAOG,KAAP,CAAT;AAAA,SAA7B;;AAEA,eAAKD,GAAL,CAASD,EAAT,CAAY,oBAAZ,EAAkC,gBAAQ;AACxC,0BAAMI,QAAN,CAAe,+BAAiBC,IAAjB,CAAf;AACD,SAFD;;AAIA,eAAKJ,GAAL,CAASD,EAAT,CAAY,mBAAZ,EAAiC,gBAAQ;AACvC,0BAAMI,QAAN,CAAe,8BAAgBE,IAAhB,CAAf;AACD,SAFD;;AAIA,eAAKL,GAAL,CAASD,EAAT,CAAY,aAAZ,EAA2B,eAAO;AAChC,0BAAMI,QAAN,CAAe,yBAAWG,GAAX,CAAf;AACD,SAFD;AAGD,OApBM,CAAP;AAqBD;;;iCAEY;AAAA;;AACX,aAAO,IAAIV,OAAJ,CAAY,mBAAW;AAC5B,eAAKD,MAAL,CAAYY,UAAZ,CAAuB,YAAM;AAC3B,iBAAKZ,MAAL,CAAYI,EAAZ,CAAe,YAAf,EAA6B,YAAM;AACjCF;AACD,WAFD;AAGD,SAJD;AAKD,OANM,CAAP;AAOD;;;yBAEIW,K,EAAOC,I,EAAM;AAAA;;AAChB,aAAO,IAAIb,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,YAAI,CAAC,OAAKE,GAAN,IAAa,CAAC,OAAKL,MAAvB,EAA+B,OAAOG,OAAO,sBAAP,CAAP;;AAE/B,YAAI,OAAKE,GAAT,EAAc;AACZ,iBAAO,OAAKA,GAAL,CAASU,IAAT,CAAcF,KAAd,EAAqBC,IAArB,EAA2B,oBAAY;AAC5C,gBAAIE,SAASV,KAAb,EAAoB;AAClBW,sBAAQX,KAAR,CAAcU,SAASV,KAAvB;AACA,qBAAOH,OAAOa,SAASV,KAAhB,CAAP;AACD;AACD,mBAAOJ,QAAQc,QAAR,CAAP;AACD,WANM,CAAP;AAOD,SARD,MAQO,IAAI,OAAKhB,MAAT,EAAiB;AACtB,iBAAOA,OAAOe,IAAP,CAAYF,KAAZ,EAAmBC,IAAnB,EAAyB,oBAAY;AAC1C,gBAAIE,SAASV,KAAb,EAAoB;AAClBW,sBAAQX,KAAR,CAAcU,SAASV,KAAvB;AACA,qBAAOH,OAAOa,SAASV,KAAhB,CAAP;AACD;AACD,mBAAOJ,QAAQc,QAAR,CAAP;AACD,WANM,CAAP;AAOD;AACF,OApBM,CAAP;AAqBD;;;uBAEEH,K,EAAOC,I,EAAM;AAAA;;AACd,aAAO,IAAIb,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,YAAI,CAAC,OAAKE,GAAN,IAAa,CAAC,OAAKL,MAAvB,EAA+B,OAAOG,OAAO,sBAAP,CAAP;;AAE/B,YAAI,OAAKE,GAAT,EAAc;AACZ,iBAAKA,GAAL,CAASD,EAAT,CAAYS,KAAZ,EAAmBC,IAAnB;AACAZ,kBAAQY,IAAR;AACD,SAHD,MAGO,IAAI,OAAKd,MAAT,EAAiB;AACtB,iBAAKA,MAAL,CAAYI,EAAZ,CAAeS,KAAf,EAAsBC,IAAtB;AACAZ;AACD;AACF,OAVM,CAAP;AAWD;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;eAGaP,M;;;;;;;;;gCAlGTA,M\",\"sourcesContent\":[\"import io from 'socket.io-client'\\nimport store from '../../store.js'\\n\\nimport {\\n  receiveAudioBlob,\\n  receiveMsg,\\n  receiveRoomMeta\\n} from '../socketio/actions.js'\\n\\nclass Socket {\\n  constructor(opts) {\\n    this.opts = {autoUpgrade: false, peerOpts: {numClients: 10}}\\n  }\\n  connect() {\\n    this.socket = io()\\n    return new Promise((resolve, reject) => {\\n      this.socket.on('connection', nsp => {\\n        // return state of socket in redux\\n        resolve(nsp)\\n      })\\n      this.socket.on('connect_error', error => reject(error))\\n    })\\n  }\\n\\n  nspConnect(namespace) {\\n    return new Promise((resolve, reject) => {\\n      this.nsp = io(`/${namespace}`)\\n      this.nsp.on('connection', nsp => {\\n        // return state of socket in redux\\n        resolve({nsp, socket})\\n      })\\n\\n      this.nsp.on('connect_error', error => reject(error))\\n\\n      this.nsp.on('receive audio blob', blob => {\\n        store.dispatch(receiveAudioBlob(blob))\\n      })\\n\\n      this.nsp.on('receive room meta', meta => {\\n        store.dispatch(receiveRoomMeta(meta))\\n      })\\n\\n      this.nsp.on('receive msg', msg => {\\n        store.dispatch(receiveMsg(msg))\\n      })\\n    })\\n  }\\n\\n  disconnect() {\\n    return new Promise(resolve => {\\n      this.socket.disconnect(() => {\\n        this.socket.on('disconnect', () => {\\n          resolve()\\n        })\\n      })\\n    })\\n  }\\n\\n  emit(event, data) {\\n    return new Promise((resolve, reject) => {\\n      if (!this.nsp || !this.socket) return reject('No socket connection')\\n\\n      if (this.nsp) {\\n        return this.nsp.emit(event, data, response => {\\n          if (response.error) {\\n            console.error(response.error)\\n            return reject(response.error)\\n          }\\n          return resolve(response)\\n        })\\n      } else if (this.socket) {\\n        return socket.emit(event, data, response => {\\n          if (response.error) {\\n            console.error(response.error)\\n            return reject(response.error)\\n          }\\n          return resolve(response)\\n        })\\n      }\\n    })\\n  }\\n\\n  on(event, data) {\\n    return new Promise((resolve, reject) => {\\n      if (!this.nsp || !this.socket) return reject('No socket connection')\\n\\n      if (this.nsp) {\\n        this.nsp.on(event, data)\\n        resolve(data)\\n      } else if (this.socket) {\\n        this.socket.on(event, data)\\n        resolve()\\n      }\\n    })\\n  }\\n\\n  // on(event, fun) {\\n  //   // No promise is needed here, but we're expecting one in the middleware.\\n  //   return new Promise((resolve, reject) => {\\n  //     if (!this.socket) return reject('No socket connection.')\\n\\n  //     this.socket.on(event, fun)\\n  //     resolve()\\n  //   })\\n  // }\\n}\\n\\nexport default Socket\\n\"]}"]}